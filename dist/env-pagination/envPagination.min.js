!function(t){function e(e,s){null!=e&&(this._options=t.extend({},a,s),this._itemsPerPage=this._options.itemsPerPageList[0],this._$container=t(e).addClass(n.cntr),this.init())}var a={itemsPerPageList:[10,30,50],totalItems:0,displayPages:10,edgePages:1,curPage:1,text:{prev:"Prev",next:"Next",ellipse:"...",totalPagesPrefix:"Page",totalPagesInfix:"of",totalPagesSufix:""},showPrev:!0,showNext:!0,showTotalPages:!0,showItemsPerPage:!0,showChangePage:!0,callback:function(t,e){return!1}},n={cntr:"epg-cntr",prevBtn:"prev-btn",nextBtn:"next-btn",pageBtn:"pg-btn",ellipse:"ellipse",current:"cur",changePage:"epg-pg-input",totalPages:"epg-tp",itemsPerPage:"epg-ipp"},s={prev:"<a class='"+n.prevBtn+"'></a>",next:"<a class='"+n.nextBtn+"'></a>",pageBtn:"<a class='"+n.pageBtn+"'></a>",ellipse:"<span class='"+n.ellipse+"'></span>",changePage:"<input class='"+n.changePage+"'/>",totalPages:"<span class='"+n.totalPages+"'><span></span><span></span><span></span></span>",itemsPerPage:"<select class='"+n.itemsPerPage+"'></select>"};e.prototype={constructor:e,_getPageCount:function(){return Math.ceil(this._options.totalItems/this._itemsPerPage)},_drawPrevBtn:function(){if(this._options.showPrev){var e=t(s.prev).text(this._options.text.prev);this._$container.prepend(e)}},_drawNextBtn:function(){if(this._options.showNext){var e=t(s.next).text(this._options.text.next);this._$container.append(e)}},_drawPageBtns:function(){var t=this._getPageCount(),e=this._options.displayPages,a=this._options.edgePages,n=Math.ceil(e/2),s=e-n,i=this._options.curPage;e+a>=t?this._appendPageBtns(1,t):t>e+a&&e+2*a>=t?a>=i?(this._appendPageBtns(1,i+e),this._appendEllipse(),this._appendPageBtns(t-a+1,t)):i>=t-a+1?(this._appendPageBtns(1,a),this._appendEllipse(),this._appendPageBtns(i-e+1,t)):this._appendPageBtns(1,t):a>=i?(this._appendPageBtns(1,i+e),this._appendEllipse(),this._appendPageBtns(t-a+1,t)):i>=t-a+1?(this._appendPageBtns(1,a),this._appendEllipse(),this._appendPageBtns(i-e+1,t)):(this._appendPageBtns(1,a),a>=i-n?(this._appendPageBtns(a+1,a+e),this._appendEllipse()):i+s+a>=t?(this._appendEllipse(),this._appendPageBtns(t-a-e+1,t-a)):(this._appendEllipse(),this._appendPageBtns(i-n+1,i+s),this._appendEllipse()),this._appendPageBtns(t-a+1,t))},_drawChangePage:function(){if(this._options.showChangePage){var e=this,a=t(s.changePage).val(this._options.curPage);if(a.keydown(function(t){if(13==t.keyCode){var n=parseInt(a.val());isNaN(n)||e.setCurPage(n,!0)}}),this._options.showTotalPages){var n=t(s.totalPages),i=n.children("span");t(i[0]).text(this._options.text.totalPagesPrefix).after(a),t(i[1]).text(this._options.text.totalPagesInfix).after("<span>"+this._getPageCount()+"</span>"),t(i[2]).text(this._options.text.totalPagesSufix),this._$container.append(n)}else this._$container.append(a)}},_drawItemsPerPage:function(){if(this._options.showItemsPerPage){var e=this,a=t(s.itemsPerPage);for(var n in this._options.itemsPerPageList){var i=parseInt(this._options.itemsPerPageList[n]);a[0].options.add(new Option(i,i))}a.val(this._itemsPerPage).change(function(){e._itemsPerPage=t(this).val(),e.setCurPage(e.getCurPage(),!0),e.init()}),this._$container.append(a)}},_appendAPageBtn:function(e){var a=t(s.pageBtn).text(e);this._$container.append(a),this._options.curPage==e&&a.addClass(n.current)},_appendPageBtns:function(t,e){for(var a=t;e>=a;a++)this._appendAPageBtn(a)},_appendEllipse:function(){this._$container.append(t(s.ellipse).text(this._options.text.ellipse))},_bindClickedCallback:function(){var e=this;this._$container.children("a").click(function(){var a,s=t(this);if(s.hasClass(n.prevBtn))a=e.getCurPage(),a>1&&(e.setCurPage(a-1),e._callback());else if(s.hasClass(n.nextBtn)){a=e.getCurPage();var i=e._getPageCount();i>a&&(e.setCurPage(a+1),e._callback())}else a=parseInt(s.text()),a!=e._options.curPage&&(e.setCurPage(a),e._callback())})},_pageChanged:function(){this.init(),this._callback()},_callback:function(){null!=this._options.callback&&"function"==typeof this._options.callback&&this._options.callback(this._options.curPage,this)},init:function(){this._$container.children().remove(),this._drawPrevBtn(),this._drawPageBtns(),this._drawNextBtn(),this._drawChangePage(),this._drawItemsPerPage(),this._bindClickedCallback()},getCurPage:function(){return this._options.curPage},setCurPage:function(t,e){var a=this._getPageCount();t>a?t=a:1>t&&(t=1),this._options.curPage!=t&&(this._options.curPage=t,this.init()),e&&this._callback()},setOptions:function(e,a){t.extend(!0,this._options,e);var n=this._getPageCount(),s=this.getCurPage();s>n&&this.setCurPage(n),this.init(),a&&this._callback()}},t.fn.envPagination=function(a){if(0==this.length)return this;if(null==e.prototype[a])return"getInstance"==a?t(this[0]).data("envPagination"):this.each(function(){var n=t(this).data("envPagination");null==n?(n=new e(this,a),t.data(this,"envPagination",n)):n.setOptions(a)});var n=e.prototype[a],s=t(this[0]).data("envPagination");return null!=s?"function"==typeof n?n.apply(s,Array.prototype.slice.call(arguments,1)):s[a]:void 0}}(jQuery);