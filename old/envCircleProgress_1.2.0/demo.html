<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="envCircleProgress.css" />
    <script type="text/javascript" src="jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="envCircleProgress.js"></script>
    <script type="text/javascript">
        function GetRandomNum(Min,Max) {   
            var Range = Max - Min;   
            var Rand = Math.random();   
            return(Min + Math.round(Rand * Range));   
        }  

        $("document").ready(function(){
            $("#p1").envCircleProgress({
                size: 280,
                decimalPlaces: 1,
                tooltipFormatter: function() {
                    var result = "<span style='color:orange'>随便设的</span><br>";
                    for (var i in this.circles) {
                        var c = this.circles[i];
                        if (c.options.text != null) {
                            result += "<span>" + (c.options.text.prefix || "") + c.curValue.toFixed(this.getOptions().decimalPlaces || 2) + (c.options.text.suffix || "") + "</span><br>";
                        } else {
                            result += "<span>" + c.curValue.toFixed(this.getOptions().decimalPlaces || 2) + "</span><br>"
                        }       
                    }

                    for(var i in this.texts) {
                        var t = this.texts[i];
                        result += "<span>" + t.options.value + "</span><br>"
                    }

                    return result;
                },
                //环
                circles: [{
                    id: "a",  //setCircleValue时可根据这个id设置指定环的值
                    angleRange: 300, //总的角度, 0-360
                    startAngle: 120, //开始角度
                    width: "5%",  //圆环的宽度，可以为数字（10）、像素值（"10px"）或百分比，当为前两者时宽为指定的定值，为百分比时宽根据svg大小计算
                    margin: 10,  //圆环离svg边缘的距离,值同上
                    anticlockwise: false, //是否逆时针
                    enableAnimation: true, //是否启用动画效果，
                    animationStep: 1, //动画效果的步进
                    initValue: 85,  //初始值
                    text: {  //环对应的文本，用来显示环的当前值
                        show: true,  //是否显示
                        size: "20px",  //字体大小
                        prefix: "a:", //文本前缀
                        suffix: "%", //文本单位/后缀
                        top: "50%"  //下边沿离svg顶部的距离
                    },
                    target: {
                        show: true,
                        value: "80%",
                    },
                    color: {
                        bg: "#23252b",  //环的背景颜色（轨道颜色）
                        fill: "#21a1c1",  //环的颜色
                        text: "#00baff"  //文字的颜色
                    }
                }, {
                    id: "b",  //setCircleValue时可根据这个id设置指定环的值
                    angleRange: 300, //总的角度, 0-360
                    startAngle: 120, //开始角度
                    width: "5%",  //圆环的宽度，可以为数字（10）、像素值（"10px"）或百分比，当为前两者时宽为指定的定值，为百分比时宽根据svg大小计算
                    margin: "20%",  //圆环离svg边缘的距离,值同上
                    anticlockwise: false, //是否逆时针
                    enableAnimation: true, //是否启用动画效果
                    animationStep: 3.7, //动画效果的步进
                    initValue: 70,  //初始值
                    text: {  //环对应的文本，用来显示环的当前值
                        show: true,  //是否显示
                        size: "16px", //字体大小
                        prefix: "b:", //文本前缀
                        suffix: "%", //文本单位/后缀
                        top: "60%" //下边沿离svg顶部的距离
                    },
                    className: {
                        bg: "ecp-ic-bg",  //环的背景（轨道）对应的class名，用于通过css定义样式（css定义的颜色优先级高于配置项中color定义的颜色）
                        fill: "ecp-ic-fill",
                        text: "ecp-ic-text"
                    }
                }],
                //其他文本
                texts: [{
                    id: "title", //setText时可根据这个id设置指定文本的值
                    value: "实际发电量",  //显示内容
                    size: "8px",  //字体大小
                    prefix: "", //文本前缀
                    suffix: "", //文本后缀
                    top: "90%", //下边沿离svg顶部的距离
                    className: "",
                    color: "red"
                }, {
                    id: "title2",
                    value: "YOYO",
                    size: "14px",
                    prefix: "", //文本前缀
                    suffix: "", //文本后缀
                    top: "75%", //下边沿离svg顶部的距离
                    className: "",
                    color: "#fff"
                }]
            });

            var xx = $("#p1").envCircleProgress();  //取得EnvCircleProgress对象

            var b = true;
            setInterval(function() {
                var d = GetRandomNum(-20, 120);
                if (b) {
                    xx.setCircleValue(0, d);  //根据circles数组中的位置来设置环对应的值
                } else {
                    xx.setCircleValue("b", d);  //根据id来设置环对应的值
                }
                b = !b;
            }, 2000);

            setTimeout(function(){
                xx.setText(0, "I chaged!");  //根据texts数组中的位置来设置文本对应的值
            }, 5000);

            setTimeout(function(){
                xx.resize();  //无参数时根据父容器大小调整自身大小
            }, 10000);

            setTimeout(function(){
                xx.resize(250);  //resize到指定大小
            }, 15000);

        });
    </script>
    <style type="text/css">
        html {background: #062e34 url(tab-bg.png); background-size: 100%}

        .ecp-ic-bg {fill: black;}
        .ecp-ic-fill {fill: #2d5988;}
        .ecp-ic-text {fill: green;}
    </style>
</head>
<body>
    <div id="p1" style="width:500px; height: 400px; margin-top: 20px; float: left;"></div>
</body>
</html>